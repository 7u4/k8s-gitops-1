apiVersion: stash.appscode.com/v1beta1
kind: BackupBlueprint
metadata:
  name: daily-backup-to-minio-keep-5
spec:
  # ============== Blueprint for Repository ==========================
  backend:
    s3:
      endpoint: "https://nas.holthome.net:9000"
      bucket: stash
      prefix: stash-backup/${TARGET_NAMESPACE}/${TARGET_KIND}/${TARGET_NAME}
    storageSecretName: stash-s3-creds
  wipeOut: false
  # ============== Blueprint for BackupConfiguration =================
  schedule: "*/10 * * * *"
  backupHistoryLimit: 3
  runtimeSettings:
    container:
      securityContext:
        runAsUser: 568
        runAsGroup: 568
  tempDir:
    medium: "Memory"
    sizeLimit: "1Gi"
    disableCaching: false
  retentionPolicy:
    name: 'keep-last-5'
    keepLast: 5
    prune: true
