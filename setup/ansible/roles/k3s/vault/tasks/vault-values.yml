---

- name: Load route53 API Key
  shell: vault kv put secrets/flux/fluxcloud slack_url="$SLACK_WEBHOOK_URL"
  environment:
    VAULT_ADDR: "{{ VAULT_ADDR }}"

- name: Load fluxcloud slack URL
  shell: vault kv put secrets/cert-manager/route53-api-key api-key="$AWS_ACCESS_KEY_SECRET"
  environment:
    VAULT_ADDR: "{{ VAULT_ADDR }}"

- name: Load Helm Chart Values
  shell: "{{ item }}"
  with_items:
    - "{{ base }}/setup/kvault.sh default/minio/minio-helm-values.txt"
    - "{{ base }}/setup/kvault.sh default/nzbget/nzbget-helm-values.txt"
  environment:
    VAULT_ADDR: "{{ VAULT_ADDR }}"