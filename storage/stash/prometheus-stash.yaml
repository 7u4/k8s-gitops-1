apiVersion: stash.appscode.com/v1alpha1
kind: Restic
metadata:
  name: stash-prometheus-server
  namespace: default
spec:
  selector:
    matchLabels:
      app: prometheus
      component: server
  fileGroups:
    - path: /data
      retentionPolicyName: "keep-last-5"
  backend:
    azure:
      container: backups
      prefix: stash
    storageSecretName: azure-secret
  schedule: "0 0 6 * * *"
  volumeMounts:
    - mountPath: /data
      name: storage-volume
  retentionPolicies:
    - name: "keep-last-5"
      keepLast: 5
      prune: true
---
apiVersion: stash.appscode.com/v1alpha1
kind: Restic
metadata:
  name: stash-prometheus-alertmanager
  namespace: default
spec:
  selector:
    matchLabels:
      app: prometheus
      component: alertmanager
  fileGroups:
    - path: /data
      retentionPolicyName: "keep-last-5"
  backend:
    azure:
      container: backups
      prefix: stash
    storageSecretName: azure-secret
  schedule: "0 30 6 * * *"
  volumeMounts:
    - mountPath: /data
      name: storage-volume
  retentionPolicies:
    - name: "keep-last-5"
      keepLast: 5
      prune: true
